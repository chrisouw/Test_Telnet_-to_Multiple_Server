$server_list = @('10.126.223.209:4','10.126.223.210:4','10.126.223.211:4','10.126.223.212:4','10.126.223.213:4','10.126.223.214:4','10.126.223.215:4','10.126.223.216:4','10.126.223.209:22','10.126.223.210:22','10.126.223.211:22','10.126.223.212:22','10.126.223.213:22','10.126.223.214:22','10.126.223.215:22','10.126.223.216:22','10.126.223.209:3151','10.126.223.210:3151','10.126.223.211:3151','10.126.223.212:3151','10.126.223.213:3151','10.126.223.214:3151','10.126.223.215:3151','10.126.223.216:3151','10.126.223.209:3152','10.126.223.210:3152','10.126.223.211:3152','10.126.223.212:3152','10.126.223.213:3152','10.126.223.214:3152','10.126.223.215:3152','10.126.223.216:3152','10.126.223.209:3153','10.126.223.210:3153','10.126.223.211:3153','10.126.223.212:3153','10.126.223.213:3153','10.126.223.214:3153','10.126.223.215:3153','10.126.223.216:3153','10.126.223.209:3154','10.126.223.210:3154','10.126.223.211:3154','10.126.223.212:3154','10.126.223.213:3154','10.126.223.214:3154','10.126.223.215:3154','10.126.223.216:3154','10.126.223.209:3155','10.126.223.210:3155','10.126.223.211:3155','10.126.223.212:3155','10.126.223.213:3155','10.126.223.214:3155','10.126.223.215:3155','10.126.223.216:3155','10.126.223.209:3156','10.126.223.210:3156','10.126.223.211:3156','10.126.223.212:3156','10.126.223.213:3156','10.126.223.214:3156','10.126.223.215:3156','10.126.223.216:3156','10.126.223.209:3157','10.126.223.210:3157','10.126.223.211:3157','10.126.223.212:3157','10.126.223.213:3157','10.126.223.214:3157','10.126.223.215:3157','10.126.223.216:3157','10.126.223.209:3158','10.126.223.210:3158','10.126.223.211:3158','10.126.223.212:3158','10.126.223.213:3158','10.126.223.214:3158','10.126.223.215:3158','10.126.223.216:3158','10.126.223.209:3159','10.126.223.210:3159','10.126.223.211:3159','10.126.223.212:3159','10.126.223.213:3159','10.126.223.214:3159','10.126.223.215:3159','10.126.223.216:3159','10.126.223.209:3160','10.126.223.210:3160','10.126.223.211:3160','10.126.223.212:3160','10.126.223.213:3160','10.126.223.214:3160','10.126.223.215:3160','10.126.223.216:3160','10.126.223.209:3161','10.126.223.210:3161','10.126.223.211:3161','10.126.223.212:3161','10.126.223.213:3161','10.126.223.214:3161','10.126.223.215:3161','10.126.223.216:3161','10.126.223.209:3162','10.126.223.210:3162','10.126.223.211:3162','10.126.223.212:3162','10.126.223.213:3162','10.126.223.214:3162','10.126.223.215:3162','10.126.223.216:3162','10.126.223.209:3163','10.126.223.210:3163','10.126.223.211:3163','10.126.223.212:3163','10.126.223.213:3163','10.126.223.214:3163','10.126.223.215:3163','10.126.223.216:3163','10.126.223.209:3164','10.126.223.210:3164','10.126.223.211:3164','10.126.223.212:3164','10.126.223.213:3164','10.126.223.214:3164','10.126.223.215:3164','10.126.223.216:3164','10.126.223.209:3165','10.126.223.210:3165','10.126.223.211:3165','10.126.223.212:3165','10.126.223.213:3165','10.126.223.214:3165','10.126.223.215:3165','10.126.223.216:3165','10.126.223.209:3166','10.126.223.210:3166','10.126.223.211:3166','10.126.223.212:3166','10.126.223.213:3166','10.126.223.214:3166','10.126.223.215:3166','10.126.223.216:3166','10.126.223.209:3251','10.126.223.210:3251','10.126.223.211:3251','10.126.223.212:3251','10.126.223.213:3251','10.126.223.214:3251','10.126.223.215:3251','10.126.223.216:3251','10.126.223.209:3252','10.126.223.210:3252','10.126.223.211:3252','10.126.223.212:3252','10.126.223.213:3252','10.126.223.214:3252','10.126.223.215:3252','10.126.223.216:3252','10.126.223.209:3253','10.126.223.210:3253','10.126.223.211:3253','10.126.223.212:3253','10.126.223.213:3253','10.126.223.214:3253','10.126.223.215:3253','10.126.223.216:3253','10.126.223.209:3254','10.126.223.210:3254','10.126.223.211:3254','10.126.223.212:3254','10.126.223.213:3254','10.126.223.214:3254','10.126.223.215:3254','10.126.223.216:3254','10.126.223.209:3255','10.126.223.210:3255','10.126.223.211:3255','10.126.223.212:3255','10.126.223.213:3255','10.126.223.214:3255','10.126.223.215:3255','10.126.223.216:3255','10.126.223.209:3256','10.126.223.210:3256','10.126.223.211:3256','10.126.223.212:3256','10.126.223.213:3256','10.126.223.214:3256','10.126.223.215:3256','10.126.223.216:3256','10.126.223.209:3257','10.126.223.210:3257','10.126.223.211:3257','10.126.223.212:3257','10.126.223.213:3257','10.126.223.214:3257','10.126.223.215:3257','10.126.223.216:3257','10.126.223.209:3258','10.126.223.210:3258','10.126.223.211:3258','10.126.223.212:3258','10.126.223.213:3258','10.126.223.214:3258','10.126.223.215:3258','10.126.223.216:3258','10.126.223.209:3259','10.126.223.210:3259','10.126.223.211:3259','10.126.223.212:3259','10.126.223.213:3259','10.126.223.214:3259','10.126.223.215:3259','10.126.223.216:3259','10.126.223.209:3260','10.126.223.210:3260','10.126.223.211:3260','10.126.223.212:3260','10.126.223.213:3260','10.126.223.214:3260','10.126.223.215:3260','10.126.223.216:3260','10.126.223.209:3261','10.126.223.210:3261','10.126.223.211:3261','10.126.223.212:3261','10.126.223.213:3261','10.126.223.214:3261','10.126.223.215:3261','10.126.223.216:3261','10.126.223.209:3262','10.126.223.210:3262','10.126.223.211:3262','10.126.223.212:3262','10.126.223.213:3262','10.126.223.214:3262','10.126.223.215:3262','10.126.223.216:3262','10.126.223.209:3263','10.126.223.210:3263','10.126.223.211:3263','10.126.223.212:3263','10.126.223.213:3263','10.126.223.214:3263','10.126.223.215:3263','10.126.223.216:3263','10.126.223.209:3264','10.126.223.210:3264','10.126.223.211:3264','10.126.223.212:3264','10.126.223.213:3264','10.126.223.214:3264','10.126.223.215:3264','10.126.223.216:3264','10.126.223.209:3265','10.126.223.210:3265','10.126.223.211:3265','10.126.223.212:3265','10.126.223.213:3265','10.126.223.214:3265','10.126.223.215:3265','10.126.223.216:3265','10.126.223.209:3266','10.126.223.210:3266','10.126.223.211:3266','10.126.223.212:3266','10.126.223.213:3266','10.126.223.214:3266','10.126.223.215:3266','10.126.223.216:3266','10.126.223.209:3351','10.126.223.210:3351','10.126.223.211:3351','10.126.223.212:3351','10.126.223.213:3351','10.126.223.214:3351','10.126.223.215:3351','10.126.223.216:3351','10.126.223.209:3352','10.126.223.210:3352','10.126.223.211:3352','10.126.223.212:3352','10.126.223.213:3352','10.126.223.214:3352','10.126.223.215:3352','10.126.223.216:3352','10.126.223.209:3353','10.126.223.210:3353','10.126.223.211:3353','10.126.223.212:3353','10.126.223.213:3353','10.126.223.214:3353','10.126.223.215:3353','10.126.223.216:3353','10.126.223.209:3354','10.126.223.210:3354','10.126.223.211:3354','10.126.223.212:3354','10.126.223.213:3354','10.126.223.214:3354','10.126.223.215:3354','10.126.223.216:3354','10.126.223.209:3355','10.126.223.210:3355','10.126.223.211:3355','10.126.223.212:3355','10.126.223.213:3355','10.126.223.214:3355','10.126.223.215:3355','10.126.223.216:3355','10.126.223.209:3356','10.126.223.210:3356','10.126.223.211:3356','10.126.223.212:3356','10.126.223.213:3356','10.126.223.214:3356','10.126.223.215:3356','10.126.223.216:3356','10.126.223.209:3357','10.126.223.210:3357','10.126.223.211:3357','10.126.223.212:3357','10.126.223.213:3357','10.126.223.214:3357','10.126.223.215:3357','10.126.223.216:3357','10.126.223.209:3358','10.126.223.210:3358','10.126.223.211:3358','10.126.223.212:3358','10.126.223.213:3358','10.126.223.214:3358','10.126.223.215:3358','10.126.223.216:3358','10.126.223.209:3359','10.126.223.210:3359','10.126.223.211:3359','10.126.223.212:3359','10.126.223.213:3359','10.126.223.214:3359','10.126.223.215:3359','10.126.223.216:3359','10.126.223.209:3360','10.126.223.210:3360','10.126.223.211:3360','10.126.223.212:3360','10.126.223.213:3360','10.126.223.214:3360','10.126.223.215:3360','10.126.223.216:3360','10.126.223.209:3361','10.126.223.210:3361','10.126.223.211:3361','10.126.223.212:3361','10.126.223.213:3361','10.126.223.214:3361','10.126.223.215:3361','10.126.223.216:3361','10.126.223.209:3362','10.126.223.210:3362','10.126.223.211:3362','10.126.223.212:3362','10.126.223.213:3362','10.126.223.214:3362','10.126.223.215:3362','10.126.223.216:3362','10.126.223.209:3363','10.126.223.210:3363','10.126.223.211:3363','10.126.223.212:3363','10.126.223.213:3363','10.126.223.214:3363','10.126.223.215:3363','10.126.223.216:3363','10.126.223.209:3364','10.126.223.210:3364','10.126.223.211:3364','10.126.223.212:3364','10.126.223.213:3364','10.126.223.214:3364','10.126.223.215:3364','10.126.223.216:3364','10.126.223.209:3365','10.126.223.210:3365','10.126.223.211:3365','10.126.223.212:3365','10.126.223.213:3365','10.126.223.214:3365','10.126.223.215:3365','10.126.223.216:3365','10.126.223.209:3366','10.126.223.210:3366','10.126.223.211:3366','10.126.223.212:3366','10.126.223.213:3366','10.126.223.214:3366','10.126.223.215:3366','10.126.223.216:3366','10.126.223.209:3451','10.126.223.210:3451','10.126.223.211:3451','10.126.223.212:3451','10.126.223.213:3451','10.126.223.214:3451','10.126.223.215:3451','10.126.223.216:3451','10.126.223.209:3452','10.126.223.210:3452','10.126.223.211:3452','10.126.223.212:3452','10.126.223.213:3452','10.126.223.214:3452','10.126.223.215:3452','10.126.223.216:3452','10.126.223.209:3453','10.126.223.210:3453','10.126.223.211:3453','10.126.223.212:3453','10.126.223.213:3453','10.126.223.214:3453','10.126.223.215:3453','10.126.223.216:3453','10.126.223.209:3454','10.126.223.210:3454','10.126.223.211:3454','10.126.223.212:3454','10.126.223.213:3454','10.126.223.214:3454','10.126.223.215:3454','10.126.223.216:3454','10.126.223.209:3455','10.126.223.210:3455','10.126.223.211:3455','10.126.223.212:3455','10.126.223.213:3455','10.126.223.214:3455','10.126.223.215:3455','10.126.223.216:3455','10.126.223.209:3456','10.126.223.210:3456','10.126.223.211:3456','10.126.223.212:3456','10.126.223.213:3456','10.126.223.214:3456','10.126.223.215:3456','10.126.223.216:3456','10.126.223.209:3457','10.126.223.210:3457','10.126.223.211:3457','10.126.223.212:3457','10.126.223.213:3457','10.126.223.214:3457','10.126.223.215:3457','10.126.223.216:3457','10.126.223.209:3458','10.126.223.210:3458','10.126.223.211:3458','10.126.223.212:3458','10.126.223.213:3458','10.126.223.214:3458','10.126.223.215:3458','10.126.223.216:3458','10.126.223.209:3459','10.126.223.210:3459','10.126.223.211:3459','10.126.223.212:3459','10.126.223.213:3459','10.126.223.214:3459','10.126.223.215:3459','10.126.223.216:3459','10.126.223.209:3460','10.126.223.210:3460','10.126.223.211:3460','10.126.223.212:3460','10.126.223.213:3460','10.126.223.214:3460','10.126.223.215:3460','10.126.223.216:3460','10.126.223.209:3461','10.126.223.210:3461','10.126.223.211:3461','10.126.223.212:3461','10.126.223.213:3461','10.126.223.214:3461','10.126.223.215:3461','10.126.223.216:3461','10.126.223.209:3462','10.126.223.210:3462','10.126.223.211:3462','10.126.223.212:3462','10.126.223.213:3462','10.126.223.214:3462','10.126.223.215:3462','10.126.223.216:3462','10.126.223.209:3463','10.126.223.210:3463','10.126.223.211:3463','10.126.223.212:3463','10.126.223.213:3463','10.126.223.214:3463','10.126.223.215:3463','10.126.223.216:3463','10.126.223.209:3464','10.126.223.210:3464','10.126.223.211:3464','10.126.223.212:3464','10.126.223.213:3464','10.126.223.214:3464','10.126.223.215:3464','10.126.223.216:3464','10.126.223.209:3465','10.126.223.210:3465','10.126.223.211:3465','10.126.223.212:3465','10.126.223.213:3465','10.126.223.214:3465','10.126.223.215:3465','10.126.223.216:3465','10.126.223.209:3466','10.126.223.210:3466','10.126.223.211:3466','10.126.223.212:3466','10.126.223.213:3466','10.126.223.214:3466','10.126.223.215:3466','10.126.223.216:3466','10.126.223.209:9001','10.126.223.210:9001','10.126.223.211:9001','10.126.223.212:9001','10.126.223.213:9001','10.126.223.214:9001','10.126.223.215:9001','10.126.223.216:9001','10.126.223.209:9002','10.126.223.210:9002','10.126.223.211:9002','10.126.223.212:9002','10.126.223.213:9002','10.126.223.214:9002','10.126.223.215:9002','10.126.223.216:9002','10.126.223.209:9012','10.126.223.210:9012','10.126.223.211:9012','10.126.223.212:9012','10.126.223.213:9012','10.126.223.214:9012','10.126.223.215:9012','10.126.223.216:9012','10.126.223.209:22381','10.126.223.210:22381','10.126.223.211:22381','10.126.223.212:22381','10.126.223.213:22381','10.126.223.214:22381','10.126.223.215:22381','10.126.223.216:22381','10.126.223.209:41001','10.126.223.210:41001','10.126.223.211:41001','10.126.223.212:41001','10.126.223.213:41001','10.126.223.214:41001','10.126.223.215:41001','10.126.223.216:41001')
#$server_list = @('hostname1:1521', 'hostname2:1521', 'hostname3:1521')

Foreach ($t in $server_list)
{
    $source = $t.Split(':')[0]
    $port = $t.Split(':')[1]
    "Connecting to $source on port $port" | Out-File -FilePath .\outuput.txt -Append
    try
        {
            $socket = New-Object System.Net.Sockets.TcpClient($source, $port)
            "Connected`n" | Out-File -FilePath .\outuput.txt -Append
        }
    catch [Exception]
        {
            $_.Exception.GetType().FullName | Out-File -FilePath .\outuput.txt -Append
            $_.Exception.Message | Out-File -FilePath .\outuput.txt -Append
        }
}
